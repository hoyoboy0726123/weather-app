<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#ff6b6b">
    <title>ğŸ‡¯ğŸ‡µ å¤§é˜ªæ—…éŠå°å¹«æ‰‹</title>
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ‡¯ğŸ‡µ</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            overflow-x: hidden;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
            min-height: 100vh;
            min-height: -webkit-fill-available;
            padding: 12px;
            padding-bottom: 85px;
            -webkit-text-size-adjust: 100%;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 15px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            padding: 0 10px;
        }

        .header h1 {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin-bottom: 15px;
            flex-wrap: wrap;
            padding: 0 5px;
        }

        .tab {
            padding: 8px 12px;
            background: rgba(255,255,255,0.3);
            border: none;
            border-radius: 20px;
            color: white;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab.active {
            background: white;
            color: #ff6b6b;
            font-weight: bold;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            overflow: hidden;
            width: 100%;
        }

        .card h2 {
            font-size: 1.2rem;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        /* Currency Converter */
        .converter-input {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
        }

        .converter-input input {
            flex: 1;
            min-width: 0;
            padding: 12px 8px;
            border: 2px solid #eee;
            border-radius: 10px;
            font-size: 16px;
            text-align: center;
        }

        .converter-input input:focus {
            outline: none;
            border-color: #ff6b6b;
        }

        .currency-label {
            text-align: center;
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }

        .result-box {
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            color: white;
            padding: 15px;
            border-radius: 15px;
            text-align: center;
            word-break: break-all;
        }

        .result-box .amount {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .result-box .label {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .rate-info {
            text-align: center;
            font-size: 0.75rem;
            color: #999;
            margin-top: 10px;
        }

        /* Expense Tracker */
        .expense-form {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }

        .expense-form input, .expense-form select {
            padding: 12px;
            border: 2px solid #eee;
            border-radius: 10px;
            font-size: 16px;
            min-width: 0;
        }

        .expense-form input[type="number"] {
            width: 80px;
            flex-shrink: 0;
        }

        .expense-form input[type="text"] {
            flex: 1;
            min-width: 100px;
        }

        .expense-form select {
            width: 70px;
            flex-shrink: 0;
        }

        .add-btn {
            padding: 12px 16px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            flex-shrink: 0;
        }

        .expense-summary {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .summary-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .summary-box .amount {
            font-size: 1.3rem;
            font-weight: bold;
            color: #333;
        }

        .summary-box .label {
            font-size: 0.8rem;
            color: #666;
        }

        .expense-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .expense-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        .expense-item:last-child {
            border-bottom: none;
        }

        .expense-item .info {
            flex: 1;
        }

        .expense-item .category {
            font-size: 0.75rem;
            color: #999;
        }

        .expense-item .amount {
            font-weight: bold;
            color: #ff6b6b;
        }

        .expense-item .delete {
            background: none;
            border: none;
            color: #ccc;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
        }

        /* Japanese Phrases */
        .phrase-category {
            margin-bottom: 15px;
        }

        .phrase-category h3 {
            font-size: 1rem;
            color: #ff6b6b;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 2px solid #feca57;
        }

        .phrase {
            padding: 12px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 8px;
        }

        .phrase .jp {
            font-size: 1.1rem;
            color: #333;
            margin-bottom: 3px;
        }

        .phrase .roma {
            font-size: 0.85rem;
            color: #ff6b6b;
            margin-bottom: 3px;
        }

        .phrase .tw {
            font-size: 0.9rem;
            color: #666;
        }

        /* Emergency Card */
        .emergency-card {
            background: linear-gradient(135deg, #c0392b, #e74c3c);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 15px;
        }

        .emergency-card h3 {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .emergency-card p {
            font-size: 0.95rem;
            margin-bottom: 5px;
        }

        .info-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .info-card h4 {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 8px;
        }

        .info-card p {
            font-size: 1rem;
            color: #333;
        }

        .editable {
            width: 100%;
            padding: 10px;
            border: 1px dashed #ccc;
            border-radius: 5px;
            font-size: 14px;
            min-height: 60px;
            resize: vertical;
            box-sizing: border-box;
        }

        /* Itinerary */
        .day-card {
            margin-bottom: 15px;
        }

        .day-header {
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            color: white;
            padding: 15px;
            border-radius: 15px 15px 0 0;
            cursor: pointer;
        }

        .day-header h3 {
            font-size: 1rem;
            margin-bottom: 3px;
        }

        .day-header p {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .day-content {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 0 0 15px 15px;
            display: none;
        }

        .day-content.show {
            display: block;
        }

        .schedule-item {
            padding: 10px 0;
            border-bottom: 1px solid #eee;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .schedule-item:last-child {
            border-bottom: none;
        }

        .schedule-item .time {
            font-weight: bold;
            color: #ff6b6b;
        }

        .highlight {
            background: #fff3cd;
            padding: 2px 6px;
            border-radius: 4px;
        }

        /* Weather */
        .weather-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 10px;
        }

        .weather-day {
            text-align: center;
            padding: 15px 10px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .weather-day .date {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 5px;
        }

        .weather-day .icon {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .weather-day .temp {
            font-size: 0.85rem;
            color: #333;
        }

        /* Bottom Nav */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            display: flex;
            justify-content: space-around;
            padding: 8px 0;
            padding-bottom: max(8px, env(safe-area-inset-bottom));
            box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
            background: none;
            border: none;
            color: #999;
            font-size: 0.65rem;
            cursor: pointer;
            padding: 4px 8px;
            min-width: 50px;
        }

        .nav-item .icon {
            font-size: 1.2rem;
        }

        .nav-item.active {
            color: #ff6b6b;
        }

        .clear-btn {
            background: #eee;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 0.85rem;
            color: #666;
            cursor: pointer;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ‡¯ğŸ‡µ å¤§é˜ªæ—…éŠå°å¹«æ‰‹</h1>
        <p>2026/2/9 - 2/15 è¦ªå­7å¤©6å¤œ</p>
    </div>

    <!-- Currency Section -->
    <div class="section active" id="currency">
        <div class="card">
            <h2>ğŸ’´ åŒ¯ç‡æ›ç®—</h2>
            <div class="currency-label">è¼¸å…¥é‡‘é¡</div>
            <div class="converter-input">
                <input type="number" id="twdInput" placeholder="å°å¹£" oninput="convertCurrency('twd')">
                <input type="number" id="jpyInput" placeholder="æ—¥å¹£" oninput="convertCurrency('jpy')">
            </div>
            <div class="result-box">
                <div class="label">æ›ç®—çµæœ</div>
                <div class="amount" id="convertResult">è¼¸å…¥é‡‘é¡é–‹å§‹æ›ç®—</div>
            </div>
            <div class="rate-info">åŒ¯ç‡ï¼š1 TWD = <span id="rateDisplay">4.65</span> JPY (å¯èª¿æ•´)</div>
            <input type="range" id="rateSlider" min="4.0" max="5.5" step="0.01" value="4.65" 
                   style="width:100%; margin-top:10px" oninput="updateRate()">
        </div>

        <div class="card">
            <h2>ğŸŒ¤ï¸ æ—…è¡ŒæœŸé–“å¤©æ°£ (2/9-15)</h2>
            <div class="weather-grid" id="weatherGrid">
                <div class="weather-day"><div class="date">è¼‰å…¥ä¸­...</div></div>
            </div>
        </div>
    </div>

    <!-- Expense Section -->
    <div class="section" id="expense">
        <div class="card">
            <h2>ğŸ“ æ—…è¡Œè¨˜å¸³</h2>
            <div class="expense-form">
                <input type="number" id="expenseAmount" placeholder="é‡‘é¡">
                <select id="expenseCategory">
                    <option value="ğŸœ é¤é£²">ğŸœ é¤</option>
                    <option value="ğŸšƒ äº¤é€š">ğŸšƒ äº¤</option>
                    <option value="ğŸ¢ é–€ç¥¨">ğŸ¢ ç¥¨</option>
                    <option value="ğŸ›ï¸ è³¼ç‰©">ğŸ›ï¸ è³¼</option>
                    <option value="ğŸ¨ ä½å®¿">ğŸ¨ ä½</option>
                    <option value="ğŸ“¦ å…¶ä»–">ğŸ“¦ ä»–</option>
                </select>
                <input type="text" id="expenseNote" placeholder="å‚™è¨»">
                <button class="add-btn" onclick="addExpense()">+</button>
            </div>
            <div class="expense-summary">
                <div class="summary-box">
                    <div class="amount" id="totalJpy">Â¥0</div>
                    <div class="label">ç¸½èŠ±è²» (æ—¥å¹£)</div>
                </div>
                <div class="summary-box">
                    <div class="amount" id="totalTwd">NT$0</div>
                    <div class="label">ç¸½èŠ±è²» (å°å¹£)</div>
                </div>
            </div>
            <div class="expense-list" id="expenseList"></div>
            <button class="clear-btn" onclick="clearExpenses()">æ¸…é™¤æ‰€æœ‰è¨˜éŒ„</button>
        </div>
    </div>

    <!-- Japanese Section -->
    <div class="section" id="japanese">
        <div class="card">
            <h2>ğŸ—£ï¸ å¯¦ç”¨æ—¥æ–‡</h2>
            
            <div class="phrase-category">
                <h3>ğŸ‘‹ åŸºæœ¬å•å€™</h3>
                <div class="phrase">
                    <div class="jp">ã™ã¿ã¾ã›ã‚“</div>
                    <div class="roma">Sumimasen</div>
                    <div class="tw">ä¸å¥½æ„æ€ / è«‹å•</div>
                </div>
                <div class="phrase">
                    <div class="jp">ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™</div>
                    <div class="roma">Arigatou gozaimasu</div>
                    <div class="tw">éå¸¸æ„Ÿè¬</div>
                </div>
            </div>

            <div class="phrase-category">
                <h3>ğŸœ é¤å»³ç”¨èª</h3>
                <div class="phrase">
                    <div class="jp">â—¯åã§ã™</div>
                    <div class="roma">â—¯ mei desu</div>
                    <div class="tw">â—¯ä½ (2å=ni mei)</div>
                </div>
                <div class="phrase">
                    <div class="jp">ã“ã‚Œã‚’ãã ã•ã„</div>
                    <div class="roma">Kore wo kudasai</div>
                    <div class="tw">è«‹çµ¦æˆ‘é€™å€‹</div>
                </div>
                <div class="phrase">
                    <div class="jp">ãŠä¼šè¨ˆãŠé¡˜ã„ã—ã¾ã™</div>
                    <div class="roma">Okaikei onegaishimasu</div>
                    <div class="tw">è«‹çµå¸³</div>
                </div>
                <div class="phrase">
                    <div class="jp">ç¾å‘³ã—ã„ã§ã™ï¼</div>
                    <div class="roma">Oishii desu!</div>
                    <div class="tw">å¾ˆå¥½åƒï¼</div>
                </div>
            </div>

            <div class="phrase-category">
                <h3>ğŸ›ï¸ è³¼ç‰©ç”¨èª</h3>
                <div class="phrase">
                    <div class="jp">ã„ãã‚‰ã§ã™ã‹ï¼Ÿ</div>
                    <div class="roma">Ikura desu ka?</div>
                    <div class="tw">å¤šå°‘éŒ¢ï¼Ÿ</div>
                </div>
                <div class="phrase">
                    <div class="jp">å…ç¨ã§ãã¾ã™ã‹ï¼Ÿ</div>
                    <div class="roma">Menzei dekimasu ka?</div>
                    <div class="tw">å¯ä»¥å…ç¨…å—ï¼Ÿ</div>
                </div>
                <div class="phrase">
                    <div class="jp">ã‚«ãƒ¼ãƒ‰ã§æ‰•ãˆã¾ã™ã‹ï¼Ÿ</div>
                    <div class="roma">Kaado de haraemasu ka?</div>
                    <div class="tw">å¯ä»¥åˆ·å¡å—ï¼Ÿ</div>
                </div>
            </div>

            <div class="phrase-category">
                <h3>ğŸšƒ äº¤é€šç”¨èª</h3>
                <div class="phrase">
                    <div class="jp">â—¯â—¯é§…ã¯ã©ã“ã§ã™ã‹ï¼Ÿ</div>
                    <div class="roma">â—¯â—¯ eki wa doko desu ka?</div>
                    <div class="tw">â—¯â—¯è»Šç«™åœ¨å“ªè£¡ï¼Ÿ</div>
                </div>
                <div class="phrase">
                    <div class="jp">ã“ã®é›»è»Šã¯â—¯â—¯ã«æ­¢ã¾ã‚Šã¾ã™ã‹ï¼Ÿ</div>
                    <div class="roma">Kono densha wa â—¯â—¯ ni tomarimasu ka?</div>
                    <div class="tw">é€™ç­é›»è»Šæœ‰åœâ—¯â—¯å—ï¼Ÿ</div>
                </div>
            </div>

            <div class="phrase-category">
                <h3>ğŸ†˜ ç·Šæ€¥ç”¨èª</h3>
                <div class="phrase">
                    <div class="jp">åŠ©ã‘ã¦ãã ã•ã„ï¼</div>
                    <div class="roma">Tasukete kudasai!</div>
                    <div class="tw">è«‹å¹«å¹«æˆ‘ï¼</div>
                </div>
                <div class="phrase">
                    <div class="jp">ç—…é™¢ã¯ã©ã“ã§ã™ã‹ï¼Ÿ</div>
                    <div class="roma">Byouin wa doko desu ka?</div>
                    <div class="tw">é†«é™¢åœ¨å“ªè£¡ï¼Ÿ</div>
                </div>
                <div class="phrase">
                    <div class="jp">è­¦å¯Ÿã‚’å‘¼ã‚“ã§ãã ã•ã„</div>
                    <div class="roma">Keisatsu wo yonde kudasai</div>
                    <div class="tw">è«‹å«è­¦å¯Ÿ</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Itinerary Section -->
    <div class="section" id="itinerary">
        <div class="card">
            <h2>ğŸ“… è¡Œç¨‹è¡¨</h2>
            
            <div class="day-card">
                <div class="day-header" onclick="toggleDay(1)">
                    <h3>Day 1 - 2/9 (ä¸€)</h3>
                    <p>æŠµé” & ç’°çƒå½±åŸå‰å“¨æˆ°</p>
                </div>
                <div class="day-content" id="day1">
                    <div class="schedule-item"><span class="time">12:00</span> æŠµé”æ°‘å®¿ (å¿ƒé½‹æ©‹/é•·å €æ©‹) å¯„æ”¾è¡Œæ</div>
                    <div class="schedule-item"><span class="time">12:30</span> åˆé¤ï¼šæ°‘å®¿é™„è¿‘å¿«é€Ÿè§£æ±º</div>
                    <div class="schedule-item"><span class="time">13:30</span> å‡ºç™¼æ­é›»è»Šå‰å¾€ç’°çƒå½±åŸ</div>
                    <div class="schedule-item"><span class="time">15:00</span> <span class="highlight">ğŸ¢ USJ å…¥å ´</span> (1.5æ—¥åˆ¸)
                        <br>â€¢ é«”é©—æ°£æ°›ã€ç©ä¸­å°è¨­æ–½
                        <br>â€¢ App æŠ½ä»»å¤©å ‚æ•´ç†åˆ¸</div>
                    <div class="schedule-item"><span class="time">20:00</span> å›æ°‘å®¿ä¼‘æ¯</div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header" onclick="toggleDay(2)">
                    <h3>Day 2 - 2/10 (äºŒ)</h3>
                    <p>ç’°çƒå½±åŸæ±ºæˆ°æ—¥ ğŸ¢</p>
                </div>
                <div class="day-content" id="day2">
                    <div class="schedule-item"><span class="time">08:00</span> æŠµé” USJ é–€å£æ’éšŠ</div>
                    <div class="schedule-item"><span class="time">09:00</span> <span class="highlight">ğŸ® ç›´è¡ä»»å¤©å ‚ä¸–ç•Œ</span></div>
                    <div class="schedule-item"><span class="time">å…¨å¤©</span> æš¢éŠ USJ
                        <br>â€¢ æŸ¯å—å¯†å®¤é€ƒè„« (éœ€é ç´„)
                        <br>â€¢ å„å¤§è¨­æ–½</div>
                    <div class="schedule-item"><span class="time">19:00</span> CityWalk æ™šé¤</div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header" onclick="toggleDay(3)">
                    <h3>Day 3 - 2/11 (ä¸‰) ğŸŒ åœ‹å®šå‡æ—¥</h3>
                    <p>éƒŠå€ç©é›ª & å‘¨é‚Šé †éŠ</p>
                </div>
                <div class="day-content" id="day3">
                    <div class="schedule-item"><span class="time">10:00</span> <span class="highlight">â›·ï¸ æšæ–¹å…¬åœ’</span> (Hirakata Park)
                        <br>â€¢ Winter Carnival ç©é›ª/æºœå†°</div>
                    <div class="schedule-item"><span class="time">16:30</span> é›¢é–‹æšæ–¹å…¬åœ’</div>
                    <div class="schedule-item"><span class="time">17:00</span> å‚æ™šäºŒé¸ä¸€ï¼š
                        <br>A. æšæ–¹ T-SITE (7ç±³æ›¸ç‰†)
                        <br>B. KUZUHA MALL (å¤§å•†å ´)</div>
                    <div class="schedule-item"><span class="time">19:00</span> <span class="highlight">ğŸ¥© ç‡’è‚‰å¤§é¤</span>
                        <br>âš ï¸ å‡æ—¥å‹™å¿…æå‰è¨‚ä½ï¼</div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header" onclick="toggleDay(4)">
                    <h3>Day 4 - 2/12 (å››)</h3>
                    <p>æµ·ç£ä¸€æ—¥éŠ (å‘¨éŠå¡ Day 1)</p>
                </div>
                <div class="day-content" id="day4">
                    <div class="schedule-item"><span class="time">09:30</span> å‰å¾€å¤§é˜ªæ¸¯</div>
                    <div class="schedule-item"><span class="time">10:00</span> <span class="highlight">ğŸ§± å¤§é˜ªæ¨‚é«˜æ¨‚åœ’</span>
                        <br>âš ï¸ è¨˜å¾—æå‰é ç´„ä¸Šåˆå ´ï¼</div>
                    <div class="schedule-item"><span class="time">12:30</span> å¤©ä¿å±± Market Place åˆé¤</div>
                    <div class="schedule-item"><span class="time">14:00</span> ğŸ  æµ·éŠé¤¨ (é–€ç¥¨è‡ªè²»)</div>
                    <div class="schedule-item"><span class="time">16:30</span> ğŸš¢ è–ç‘ªéº—äºè™Ÿè§€å…‰èˆ¹ (å‘¨éŠå¡å…è²»)</div>
                    <div class="schedule-item"><span class="time">17:30</span> ğŸ¡ å¤©ä¿å±±å¤§æ‘©å¤©è¼ª (å‘¨éŠå¡å…è²»)</div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header" onclick="toggleDay(5)">
                    <h3>Day 5 - 2/13 (äº”)</h3>
                    <p>æŸ¯å—ã€å‹•ç‰©åœ’èˆ‡å¤œæ™¯ (å‘¨éŠå¡ Day 2)</p>
                </div>
                <div class="day-content" id="day5">
                    <div class="schedule-item"><span class="time">09:00</span> <span class="highlight">ğŸ•µï¸ è®€è³£é›»è¦–å° (YTV)</span>
                        <br>æŸ¯å—é›•åƒå·¡ç¦® (å¤§é˜ªå•†å‹™åœ’å€ç«™)</div>
                    <div class="schedule-item"><span class="time">11:00</span> ğŸ¦ å¤©ç‹å¯ºå‹•ç‰©åœ’ (å‘¨éŠå¡å…è²»)</div>
                    <div class="schedule-item"><span class="time">15:00</span> ä¸‹åˆèŒ¶/ä¼‘æ¯ (MIO æˆ– Q's Mall)</div>
                    <div class="schedule-item"><span class="time">16:30</span> <span class="highlight">ğŸŒƒ é˜¿å€é‡ Harukas 300</span>
                        <br>å±•æœ›å°çœ‹æ—¥è½è‡³å¤œæ™¯</div>
                    <div class="schedule-item"><span class="time">19:30</span> ğŸ›¶ é“é “å €æ°´ä¸Šè§€å…‰èˆ¹ (å‘¨éŠå¡å…è²»)</div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header" onclick="toggleDay(6)">
                    <h3>Day 6 - 2/14 (å…­) â¤ï¸</h3>
                    <p>è§’è‰²è£œå®Œ & é€šå¤©é–£æ–°ä¸–ç•Œ</p>
                </div>
                <div class="day-content" id="day6">
                    <div class="schedule-item"><span class="time">10:00</span> <span class="highlight">ğŸ›ï¸ å¤§ä¸¸ç™¾è²¨å¿ƒé½‹æ©‹åº— 9F</span>
                        <br>â€¢ å“†å•¦Aå¤¢æœªä¾†ç™¾è²¨
                        <br>â€¢ Pokemon Center</div>
                    <div class="schedule-item"><span class="time">12:00</span> ğŸ¦€ é»‘é–€å¸‚å ´ (å’Œç‰›ã€æµ·é®®)</div>
                    <div class="schedule-item"><span class="time">13:30</span> ğŸ® æ—¥æœ¬æ©‹é›»å™¨è¡— (å‹•æ¼«ã€è½‰è›‹)</div>
                    <div class="schedule-item"><span class="time">15:30</span> <span class="highlight">ğŸ—¼ é€šå¤©é–£ & æ–°ä¸–ç•Œ</span>
                        <br>â€¢ Tower Slider æºœæ»‘æ¢¯ (è‡ªè²»)
                        <br>â€¢ ä¸²ç‚¸æ™šé¤</div>
                    <div class="schedule-item"><span class="time">18:00</span> å›å¿ƒé½‹æ©‹æœ€å¾Œè£œè²¨</div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header" onclick="toggleDay(7)">
                    <h3>Day 7 - 2/15 (æ—¥)</h3>
                    <p>ç§»å‹•æ—¥ & Outlet</p>
                </div>
                <div class="day-content" id="day7">
                    <div class="schedule-item"><span class="time">ä¸Šåˆ</span> é€€æˆ¿ï¼Œç§»å‹•è‡³è‡¨ç©ºåŸä½å®¿</div>
                    <div class="schedule-item"><span class="time">ä¸‹åˆ</span> <span class="highlight">ğŸ›ï¸ Rinku Premium Outlets</span>
                        <br>æœ€å¾Œæ¡è²·ï¼</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Emergency Section -->
    <div class="section" id="emergency">
        <div class="card">
            <h2>ğŸ†˜ ç·Šæ€¥è³‡è¨Š</h2>
            
            <div class="emergency-card">
                <h3>ğŸ“ ç·Šæ€¥é›»è©±</h3>
                <p>è­¦å¯Ÿï¼š<strong>110</strong></p>
                <p>ç«ç½/æ€¥æ•‘ï¼š<strong>119</strong></p>
                <p>å°ç£é§æ—¥ä»£è¡¨è™•ï¼š<strong>03-3280-7811</strong></p>
            </div>

            <div class="info-card">
                <h4>ğŸ¨ ä½å®¿åœ°å€ (çµ¦å¸æ©Ÿçœ‹)</h4>
                <textarea class="editable" id="hotelAddress" placeholder="è¼¸å…¥ä½ çš„æ°‘å®¿/é£¯åº—åœ°å€ï¼ˆæ—¥æ–‡ï¼‰"
                    oninput="saveEmergencyInfo()">å¿ƒé½‹æ©‹/é•·å €æ©‹ æ°‘å®¿
ï¼ˆè«‹åœ¨æ­¤è¼¸å…¥è©³ç´°åœ°å€ï¼‰</textarea>
            </div>

            <div class="info-card">
                <h4>ğŸ“‹ è­·ç…§è³‡è¨Š</h4>
                <textarea class="editable" id="passportInfo" placeholder="è­·ç…§è™Ÿç¢¼ç­‰é‡è¦è³‡è¨Š"
                    oninput="saveEmergencyInfo()">è­·ç…§è™Ÿç¢¼ï¼š
æœ‰æ•ˆæœŸé™ï¼š</textarea>
            </div>

            <div class="info-card">
                <h4>ğŸ’Š éæ•/ç–¾ç—… (çµ¦é†«ç”Ÿçœ‹)</h4>
                <textarea class="editable" id="medicalInfo" placeholder="è—¥ç‰©éæ•ã€æ…¢æ€§ç—…ç­‰"
                    oninput="saveEmergencyInfo()">ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ (éæ•)ï¼š
æŒç—… (æ…¢æ€§ç—…)ï¼š</textarea>
            </div>

            <div class="info-card">
                <h4>ğŸ“± ç·Šæ€¥è¯çµ¡äºº</h4>
                <textarea class="editable" id="emergencyContact" placeholder="å°ç£å®¶äººè¯çµ¡æ–¹å¼"
                    oninput="saveEmergencyInfo()">å§“åï¼š
é›»è©±ï¼š</textarea>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <button class="nav-item active" onclick="showSection('currency')">
            <span class="icon">ğŸ’´</span>
            <span>åŒ¯ç‡</span>
        </button>
        <button class="nav-item" onclick="showSection('expense')">
            <span class="icon">ğŸ“</span>
            <span>è¨˜å¸³</span>
        </button>
        <button class="nav-item" onclick="showSection('japanese')">
            <span class="icon">ğŸ—£ï¸</span>
            <span>æ—¥æ–‡</span>
        </button>
        <button class="nav-item" onclick="showSection('itinerary')">
            <span class="icon">ğŸ“…</span>
            <span>è¡Œç¨‹</span>
        </button>
        <button class="nav-item" onclick="showSection('emergency')">
            <span class="icon">ğŸ†˜</span>
            <span>ç·Šæ€¥</span>
        </button>
    </div>

    <script>
        // Exchange rate
        let exchangeRate = 4.65;

        function updateRate() {
            exchangeRate = parseFloat(document.getElementById('rateSlider').value);
            document.getElementById('rateDisplay').textContent = exchangeRate.toFixed(2);
            convertCurrency('twd');
        }

        function convertCurrency(source) {
            const twdInput = document.getElementById('twdInput');
            const jpyInput = document.getElementById('jpyInput');
            const result = document.getElementById('convertResult');

            if (source === 'twd' && twdInput.value) {
                const twd = parseFloat(twdInput.value);
                const jpy = Math.round(twd * exchangeRate);
                jpyInput.value = jpy;
                result.textContent = `NT$${twd.toLocaleString()} = Â¥${jpy.toLocaleString()}`;
            } else if (source === 'jpy' && jpyInput.value) {
                const jpy = parseFloat(jpyInput.value);
                const twd = Math.round(jpy / exchangeRate);
                twdInput.value = twd;
                result.textContent = `Â¥${jpy.toLocaleString()} = NT$${twd.toLocaleString()}`;
            } else {
                result.textContent = 'è¼¸å…¥é‡‘é¡é–‹å§‹æ›ç®—';
            }
        }

        // IndexedDB for expense tracker
        let db;
        let expenses = [];
        const DB_NAME = 'OsakaTravelDB';
        const DB_VERSION = 1;
        const STORE_NAME = 'expenses';

        // Initialize IndexedDB
        function initDB() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(DB_NAME, DB_VERSION);
                
                request.onerror = () => reject(request.error);
                request.onsuccess = () => {
                    db = request.result;
                    resolve(db);
                };
                
                request.onupgradeneeded = (event) => {
                    const database = event.target.result;
                    if (!database.objectStoreNames.contains(STORE_NAME)) {
                        database.createObjectStore(STORE_NAME, { keyPath: 'id' });
                    }
                };
            });
        }

        // Load all expenses from IndexedDB
        async function loadExpenses() {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction(STORE_NAME, 'readonly');
                const store = transaction.objectStore(STORE_NAME);
                const request = store.getAll();
                
                request.onsuccess = () => {
                    expenses = request.result || [];
                    resolve(expenses);
                };
                request.onerror = () => reject(request.error);
            });
        }

        // Save expense to IndexedDB
        async function saveExpense(expense) {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction(STORE_NAME, 'readwrite');
                const store = transaction.objectStore(STORE_NAME);
                const request = store.put(expense);
                
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        // Delete expense from IndexedDB
        async function removeExpense(id) {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction(STORE_NAME, 'readwrite');
                const store = transaction.objectStore(STORE_NAME);
                const request = store.delete(id);
                
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        // Clear all expenses from IndexedDB
        async function clearAllExpenses() {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction(STORE_NAME, 'readwrite');
                const store = transaction.objectStore(STORE_NAME);
                const request = store.clear();
                
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        async function addExpense() {
            const amount = document.getElementById('expenseAmount').value;
            const category = document.getElementById('expenseCategory').value;
            const note = document.getElementById('expenseNote').value;

            if (!amount) return;

            const expense = {
                id: Date.now(),
                amount: parseFloat(amount),
                category,
                note,
                date: new Date().toLocaleDateString('zh-TW')
            };

            expenses.push(expense);
            await saveExpense(expense);
            
            document.getElementById('expenseAmount').value = '';
            document.getElementById('expenseNote').value = '';
            renderExpenses();
        }

        async function deleteExpense(id) {
            expenses = expenses.filter(e => e.id !== id);
            await removeExpense(id);
            renderExpenses();
        }

        async function clearExpenses() {
            if (confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰è¨˜éŒ„å—ï¼Ÿ')) {
                expenses = [];
                await clearAllExpenses();
                renderExpenses();
            }
        }

        function renderExpenses() {
            const list = document.getElementById('expenseList');
            const totalJpy = expenses.reduce((sum, e) => sum + e.amount, 0);
            const totalTwd = Math.round(totalJpy / exchangeRate);

            document.getElementById('totalJpy').textContent = `Â¥${totalJpy.toLocaleString()}`;
            document.getElementById('totalTwd').textContent = `NT$${totalTwd.toLocaleString()}`;

            list.innerHTML = expenses.slice().reverse().map(e => `
                <div class="expense-item">
                    <div class="info">
                        <div>${e.note || e.category}</div>
                        <div class="category">${e.category} Â· ${e.date}</div>
                    </div>
                    <div class="amount">Â¥${e.amount.toLocaleString()}</div>
                    <button class="delete" onclick="deleteExpense(${e.id})">Ã—</button>
                </div>
            `).join('');
        }

        // Section navigation
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        // Itinerary toggle
        function toggleDay(day) {
            const content = document.getElementById('day' + day);
            content.classList.toggle('show');
        }

        // Emergency info save/load
        function saveEmergencyInfo() {
            const info = {
                hotelAddress: document.getElementById('hotelAddress').value,
                passportInfo: document.getElementById('passportInfo').value,
                medicalInfo: document.getElementById('medicalInfo').value,
                emergencyContact: document.getElementById('emergencyContact').value
            };
            localStorage.setItem('osaka_emergency', JSON.stringify(info));
        }

        function loadEmergencyInfo() {
            const info = JSON.parse(localStorage.getItem('osaka_emergency') || '{}');
            if (info.hotelAddress) document.getElementById('hotelAddress').value = info.hotelAddress;
            if (info.passportInfo) document.getElementById('passportInfo').value = info.passportInfo;
            if (info.medicalInfo) document.getElementById('medicalInfo').value = info.medicalInfo;
            if (info.emergencyContact) document.getElementById('emergencyContact').value = info.emergencyContact;
        }

        // Weather - é¡¯ç¤ºæ—…è¡ŒæœŸé–“ 2/9 - 2/15 çš„å¤©æ°£
        async function loadWeather() {
            try {
                // å–å¾— 16 å¤©é å ±ä»¥æ¶µè“‹æ—…è¡Œæ—¥æœŸ
                const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=34.69&longitude=135.50&daily=temperature_2m_max,temperature_2m_min,weathercode&timezone=Asia/Tokyo&forecast_days=16');
                const data = await res.json();
                
                const weatherCodes = {
                    0: 'â˜€ï¸', 1: 'ğŸŒ¤ï¸', 2: 'â›…', 3: 'â˜ï¸', 45: 'ğŸŒ«ï¸', 48: 'ğŸŒ«ï¸',
                    51: 'ğŸŒ§ï¸', 53: 'ğŸŒ§ï¸', 55: 'ğŸŒ§ï¸', 61: 'ğŸŒ§ï¸', 63: 'ğŸŒ§ï¸', 65: 'ğŸŒ§ï¸',
                    71: 'ğŸŒ¨ï¸', 73: 'ğŸŒ¨ï¸', 75: 'â„ï¸', 80: 'ğŸŒ§ï¸', 81: 'ğŸŒ§ï¸', 82: 'â›ˆï¸',
                    95: 'â›ˆï¸', 96: 'â›ˆï¸', 99: 'â›ˆï¸'
                };

                // æ—…è¡Œæ—¥æœŸï¼š2026/2/9 - 2/15
                const tripStart = '2026-02-09';
                const tripEnd = '2026-02-15';
                
                const grid = document.getElementById('weatherGrid');
                const tripDays = [];
                
                data.daily.time.forEach((date, i) => {
                    if (date >= tripStart && date <= tripEnd) {
                        const d = new Date(date);
                        const day = ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'][d.getDay()];
                        const dayNum = Math.floor((new Date(date) - new Date(tripStart)) / 86400000) + 1;
                        tripDays.push(`
                            <div class="weather-day">
                                <div class="date">D${dayNum} ${d.getMonth()+1}/${d.getDate()}</div>
                                <div class="icon">${weatherCodes[data.daily.weathercode[i]] || 'ğŸŒ¡ï¸'}</div>
                                <div class="temp">${Math.round(data.daily.temperature_2m_max[i])}Â°/${Math.round(data.daily.temperature_2m_min[i])}Â°</div>
                            </div>
                        `);
                    }
                });
                
                if (tripDays.length > 0) {
                    grid.innerHTML = tripDays.join('');
                } else {
                    grid.innerHTML = '<div class="weather-day"><div class="date">å¤©æ°£é å ±å°‡æ–¼å‡ºç™¼å‰ä¸€é€±æ›´æ–°</div></div>';
                }
            } catch (e) {
                document.getElementById('weatherGrid').innerHTML = '<div class="weather-day"><div class="date">ç„¡æ³•è¼‰å…¥å¤©æ°£</div></div>';
            }
        }

        // Init
        async function init() {
            await initDB();
            await loadExpenses();
            renderExpenses();
            loadEmergencyInfo();
            loadWeather();
        }
        
        init();
    </script>
</body>
</html>
